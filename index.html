<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>ibonarium :: JWST API key mode</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;background:#000;color:#cfefff;font-family:Inter,system-ui,monospace;overflow:hidden;}

#jwst-bg{position:fixed;inset:0;background-size:cover;background-position:center;opacity:0;transition:opacity 1.8s ease, filter .8s ease;}

.ir{filter:brightness(0.85)contrast(1.25)saturate(1.3)hue-rotate(35deg);}

#overlay{position:fixed;inset:0;background:radial-gradient(circle at center,rgba(0,0,0,0.25),#000 80%);pointer-events:none;}

#controls{position:absolute;top:16px;left:16px;display:flex;gap:8px;}
button{background:rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.15);color:#cfefff;padding:6px 10px;border-radius:10px;cursor:pointer;font-size:13px;}
button.active{border-color:#fff;color:#fff;}

#panel{position:absolute;bottom:16px;left:16px;background:rgba(0,0,0,0.45);backdrop-filter:blur(6px);padding:12px 16px;border-radius:12px;font-size:14px;line-height:1.5;max-width:420px;}
</style>
</head>

<body>

<div id="jwst-bg"></div>
<div id="overlay"></div>

<div id="controls">
    <button onclick="setMode('silence')">Тиша</button>
    <button onclick="setMode('memory')">Памʼять</button>
    <button onclick="setMode('novelty')">Новизна</button>
    <button onclick="toggleIR()">IR</button>
</div>

<div id="panel">
    <b>JWST Observer</b><br>
    Режим: <span id="modeLabel"></span><br>
    <span id="meta"></span>
</div>

<script>
const API_KEY = "a1686b45-a59a-478c-85a3-cc44c95ea90e"; // твій API ключ
let currentMode = "memory";
let irOn = false;

// встановлюємо режим
function setMode(m){
    currentMode = m;
    document.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
    fetchImages();
}

function toggleIR(){
    irOn = !irOn;
    document.getElementById("jwst-bg").classList.toggle("ir", irOn);
}

// завантажити фото
async function fetchImages(){
    document.getElementById("modeLabel").textContent = currentMode;

    // ключ + URL
    const url = `https://jwstapi.com/api/v1/images?key=${API_KEY}&limit=50`;
    const res = await fetch(url);
    const json = await res.json();

    if(!json || !json.data || !json.data.length) return;

    let selected;

    if(currentMode === "novelty"){
        // найновіше — перший
        selected = json.data[0];
    } else if(currentMode === "memory"){
        // випадкове з перших 30
        selected = json.data[Math.floor(Math.random() * Math.min(json.data.length,30))];
    } else {
        // Тиша — найспокійніший (останній у списку)
        selected = json.data[json.data.length - 1];
    }

    showImage(selected);
}

function showImage(item){
    const bg = document.getElementById("jwst-bg");
    bg.style.backgroundImage = `url(${item.imageUrl})`;
    bg.style.opacity = "1";

    document.getElementById("meta").innerHTML =
        `Назва: ${item.title || "—"}<br>
         Камера: ${item.instrument || "—"}<br>
         Дата: ${item.obsDate || "—"}`;
}

fetchImages();
</script>

</body>
</html>
