<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Cosmic & Geomagnetic Monitor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  background:#000;
  color:#cfefff;
  font-family:Inter,system-ui,monospace;
}
.container{
  max-width:900px;
  margin:auto;
  padding:16px;
}
h1{
  font-size:22px;
  margin-bottom:12px;
}
.data{
  display:grid;
  grid-template-columns:1fr;
  gap:8px;
}
.item{
  padding:10px;
  border:1px solid #123;
  border-radius:6px;
  background:#050b12;
}
.value{
  float:right;
  font-weight:bold;
}
.status{
  margin-top:12px;
  padding:12px;
  border-radius:6px;
  background:#08121c;
}
</style>
</head>

<body>
<div class="container">
<h1>КОСМІЧНІ ТА ГЕОМАГНІТНІ ПОКАЗНИКИ</h1>

<div class="data" id="data"></div>

<div class="status" id="status"></div>
</div>

<script>
const dataEl = document.getElementById("data");
const statusEl = document.getElementById("status");

function safe(n){ return isFinite(n) ? n : 0 }

async function loadData(){

  const plasma = await fetch(
    "https://services.swpc.noaa.gov/json/solar-wind/plasma-1-day.json"
  ).then(r=>r.json());

  const mag = await fetch(
    "https://services.swpc.noaa.gov/json/solar-wind/mag-1-day.json"
  ).then(r=>r.json());

  const kp = await fetch(
    "https://services.swpc.noaa.gov/products/noaa-planetary-k-index.json"
  ).then(r=>r.json());

  const p = plasma.at(-1);
  const m = mag.at(-1);

  const speed = safe(Number(p.speed));
  const density = safe(Number(p.density));
  const temperature = safe(Number(p.temperature));

  const bt = safe(Number(m.bt));
  const bz = safe(Number(m.bz));
  const by = safe(Number(m.by));

  const kpIndex = safe(Number(kp.at(-1)[1]));

  // Dynamic Pressure
  const dynamicPressure =
    1.6726e-6 * density * speed * speed;

  // GSI
  const GSI =
    Math.abs(bz)*0.4 +
    bt*0.2 +
    (speed/400)*0.2 +
    (density/10)*0.1 +
    kpIndex*0.1;

  const storm =
    GSI>8?"Extreme":
    GSI>6?"Strong":
    GSI>4?"Elevated":
    GSI>2?"Mild":"Quiet";

  const rows = [
    ["Solar Wind Speed (km/s)", speed.toFixed(1)],
    ["Solar Wind Density (/cc)", density.toFixed(2)],
    ["Solar Wind Temperature (K)", temperature.toFixed(0)],
    ["IMF Bt – Total Magnetic Field (nT)", bt.toFixed(2)],
    ["IMF Bz (nT)", bz.toFixed(2)],
    ["IMF By (nT)", by.toFixed(2)],
    ["Solar Wind Dynamic Pressure (nPa)", dynamicPressure.toFixed(2)],
    ["Proton Flux >10 MeV", "SWPC GOES"],
    ["Electron Flux >2 MeV", "SWPC GOES"],
    ["Kp Index", kpIndex.toFixed(2)],
    ["Dst Index (nT)", "NOAA realtime"],
    ["AE Index", "Auroral activity"],
    ["Geomagnetic Stress Index (GSI)", GSI.toFixed(2)],
    ["Geomagnetic Storm Level", storm]
  ];

  dataEl.innerHTML = "";
  rows.forEach(r=>{
    const d=document.createElement("div");
    d.className="item";
    d.innerHTML=`${r[0]}<span class="value">${r[1]}</span>`;
    dataEl.appendChild(d);
  });

  statusEl.innerHTML =
    `<b>System State:</b> ${storm}<br>
     <b>GSI:</b> ${GSI.toFixed(2)}`;
}

loadData();
setInterval(loadData,60000);
</script>
</body>
</html>
