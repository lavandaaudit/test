<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>ibonarium.radio.callisto</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{
    width:100%;
    height:100%;
    background:#000;
    color:#cfefff;
    font-family:Inter,system-ui,monospace;
    overflow:hidden;
}

header{
    height:48px;
    padding:10px 18px;
    border-bottom:1px solid rgba(255,255,255,0.08);
    display:flex;
    justify-content:space-between;
    font-size:13px;
    letter-spacing:1px;
}

main{
    display:grid;
    grid-template-columns:360px 1fr;
    height:calc(100% - 48px);
}

aside{
    padding:14px;
    border-right:1px solid rgba(255,255,255,0.08);
    overflow-y:auto;
}

h2{
    font-size:12px;
    opacity:0.7;
    margin-bottom:10px;
}

.metric{
    margin-bottom:14px;
}
.metric span{
    display:block;
    font-size:11px;
    opacity:0.5;
}
.metric strong{
    font-size:15px;
}

section{
    position:relative;
    background:#000;
}

canvas{
    width:100%;
    height:100%;
    display:block;
    background:#000;
}

footer{
    position:absolute;
    bottom:10px;
    right:16px;
    font-size:11px;
    opacity:0.4;
}
</style>
</head>

<body>

<header>
    <div>IBONARIUM · e-CALLISTO</div>
    <div>real solar radio noise</div>
</header>

<main>

<aside>
    <h2>Реальне джерело</h2>

    <div class="metric"><span>Network</span><strong>e-CALLISTO</strong></div>
    <div class="metric"><span>Station</span><strong>Birr</strong></div>
    <div class="metric"><span>Frequency</span><strong>~45 – 870 MHz</strong></div>
    <div class="metric"><span>UTC</span><strong id="utc">—</strong></div>

    <h2 style="margin-top:20px">Ібонаріум</h2>
    <div class="metric"><span>Field state</span><strong>Structured chaos</strong></div>
    <div class="metric"><span>Interpretation</span><strong>Active vacuum</strong></div>
</aside>

<section>
    <canvas id="view"></canvas>
    <footer>radio noise ≠ silence</footer>
</section>

</main>

<script>
const STATION = "Birr";
const URL = `https://www.e-callisto.org/quicklook/${STATION}/latest.png`;

const canvas = document.getElementById("view");
const ctx = canvas.getContext("2d");
const utc = document.getElementById("utc");

function resize(){
    canvas.width = canvas.clientWidth;
    canvas.height = canvas.clientHeight;
}
window.addEventListener("resize", resize);
resize();

async function loadSpectrogram(){
    try{
        const res = await fetch(URL, { cache: "no-store" });
        const blob = await res.blob();
        const img = new Image();
        img.onload = () => {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            URL.revokeObjectURL(img.src);
        };
        img.src = URL.createObjectURL(blob);
        utc.textContent = new Date().toUTCString();
    }catch(e){
        ctx.fillStyle = "#f55";
        ctx.fillText("DATA BLOCKED", 20, 40);
    }
}

loadSpectrogram();
setInterval(loadSpectrogram, 5 * 60 * 1000);
</script>

</body>
</html>
